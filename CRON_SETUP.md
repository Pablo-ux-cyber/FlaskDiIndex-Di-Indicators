# Настройка автоматического обновления данных

Для автоматического обновления данных DI индекса необходимо настроить планировщик задач (cron) на сервере.

## Подготовка

1. Убедитесь, что скрипт `daily_update.py` имеет права на выполнение:

```bash
chmod +x daily_update.py
```

2. Удостоверьтесь, что в файле `tracked_symbols.json` указаны все криптовалюты, для которых вы хотите автоматически собирать данные.

## Настройка cron-задачи

1. Откройте редактор crontab:

```bash
crontab -e
```

2. Добавьте следующую строку для запуска скрипта ежедневно в 1:00 ночи (можно выбрать любое другое время):

```
0 1 * * * cd /путь/к/проекту && /usr/bin/python3 daily_update.py >> daily_update.log 2>&1
```

Замените `/путь/к/проекту` на абсолютный путь к корневой папке проекта, например `/var/www/html/di_index_new`.

## Проверка работы

1. Проверьте, что задание добавлено в crontab:

```bash
crontab -l
```

2. Для тестирования можно запустить скрипт вручную:

```bash
cd /путь/к/проекту
python3 daily_update.py
```

3. Проверьте файл журнала `daily_update.log` для подтверждения, что скрипт работает правильно.

## Что делает скрипт автоматического обновления?

1. Загружает список отслеживаемых криптовалют из файла `tracked_symbols.json`
2. Последовательно запрашивает и обновляет данные для каждой монеты
3. Автоматически сохраняет как исходные 4-часовые данные OHLCV, так и рассчитанные значения DI индекса
4. Ведет журнал обновлений в файле `daily_update.log`

При каждом запуске скрипт:
- Проверяет валидность каждого символа
- Обрабатывает монеты небольшими пакетами, чтобы не перегружать API
- Объединяет новые данные с уже имеющейся историей

## Настройка списка отслеживаемых монет

Чтобы изменить список отслеживаемых монет, отредактируйте файл `tracked_symbols.json`. 

Текущий список включает:
```json
[
  "BTC", "ETH", "XRP", "LTC", "ADA", 
  "DOT", "SOL", "DOGE", "LINK", "AVAX",
  "BNB", "MATIC", "UNI", "SHIB", "ATOM"
]
```

Вы можете добавить или удалить монеты по своему усмотрению. После редактирования файла следующий запуск скрипта будет использовать обновленный список.