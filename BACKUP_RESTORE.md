# Бэкап и восстановление системы (26.03.2025)

## Структура системы

### Основные компоненты:
1. server.py - основной файл с бизнес-логикой
2. templates/index.html - пользовательский интерфейс

### Логика работы системы:
1. Сбор данных:
   - Получение данных с CryptoCompare API в трех временных масштабах:
     * Weekly (недельные данные)
     * Daily (дневные данные)
     * 4h (4-часовые данные)

2. Расчет индикаторов:
   - DI Index считается для каждого временного масштаба
   - Компоненты индекса: MA, Willy, MACD, OBV, MFI, AD
   - Все компоненты суммируются для получения итогового значения

3. Отображение данных:
   - Daily данные показываются за предыдущий полный день (например, 25 марта показываются данные за 24 марта 00:00-23:59 UTC)
   - В таблице показываются значения за 20:00:00 UTC для 4h индикатора
   - При клике на ячейку 4h показываются все значения за день (00:00, 04:00, 08:00, 12:00, 16:00, 20:00)
   - Тренд определяется на основе пересечения 13 EMA и 30 SMA

## Процедура восстановления

1. Файлы бэкапа:
   ```
   server.py.bak
   templates/index.html.bak
   ```

2. Для восстановления:
   - Переименуйте .bak файлы, убрав расширение .bak
   - Или скопируйте содержимое .bak файлов в соответствующие рабочие файлы

3. После восстановления:
   - Перезапустите сервер
   - Проверьте, что значения 4h показываются корректно за 20:00:00 UTC
   - Проверьте работу модального окна с историей 4h значений

## Важные заметки:
- Кэширование данных настроено на 2 часа (CACHE_DURATION = 7200)
- Используется многопоточная обработка с MAX_WORKERS = 5
- API ключ берется из переменной окружения CRYPTOCOMPARE_API_KEY